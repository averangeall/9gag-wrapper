<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>9GAG Captain Obvious</title>
        <link href="/static/css/bootstrap.min.css" rel="stylesheet" media="screen">
        <script src="http://code.jquery.com/jquery-latest.js"></script>
        <script src="/static/js/bootstrap.min.js"></script>
        <script>
            $(function() {
                var comments = $("[class^=comment_]");
                var uids = new Array();
                for(var idx in comments) {
                    var comment = $(comments[idx]);
                    var class_name = comment.attr('class');
                    if(class_name == undefined) // weird
                        continue;
                    var tokens = class_name.split('_');
                    var uid = tokens[1];
                    if($.inArray(uid, uids) == -1)
                        uids.push(uid);
                }
                for(var idx in uids) {
                    $.get('/graph/comment', {uid: uids[idx]}, function(res) {
                        $('.profile_' + res.uid).attr('src', res.profile);
                        $('.name_' + res.uid).html(res.name);
                    }, 'json');
                }
            });
        </script>
        <style type="text/css">
            body {
                padding-top: 90px;
                padding-bottom: 40px;
            }
        </style>
    </head>
    <body>
        <div class="navbar navbar-inverse navbar-fixed-top">
          <div class="navbar-inner">
            <div class="container">
              <div class="nav-collapse collapse">
                <h1 class="muted">9GAG Captain Obvious</h1>
              </div>
            </div>
          </div>
        </div>

        <div class="container">
            <div class="container" style="width: 50%; margin: 0 auto 20px;">
                <img src="{{ gag_img_url }}" class="img-polaroid" />
            </div>
            <table class="table">
                {% for comment in gag_comments %}
                    <tr class="comment_{{ comment.uid }}">
                        {% if not comment.is_lead %}
                            <td></td>
                        {% endif %}
                        <td width="60px">
                            <img src="/static/img/yao-ming.jpg" class="profile_{{ comment.uid }}" />
                        </td>
                        {% if not comment.is_lead %}
                            <td>
                        {% else %}
                            <td colspan="2">
                        {% endif %}
                            <p class="name_{{ comment.uid }}">Somebody</p>
                            <p>{{ comment.content }}</p>
                        </td>
                    </tr>
                {% endfor %}
            </table>
        </div>
    </body>
</html>

